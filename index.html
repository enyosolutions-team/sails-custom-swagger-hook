<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Sails-custom-swagger-hook by jasancheg</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Sails-custom-swagger-hook</h1>
        <h2></h2>
        <a href="https://github.com/jasancheg/sails-custom-swagger-hook" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="sails-custom-swagger-hook" class="anchor" href="#sails-custom-swagger-hook" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>sails-custom-swagger-hook</h1>

<p><a href="https://npmjs.org/package/sails-custom-swagger-hook"><img src="https://badge.fury.io/js/sails-custom-swagger-hook.svg?style=flat" alt="NPM version"></a>
<a href="https://david-dm.org/jasancheg/sails-custom-swagger-hook"><img src="http://img.shields.io/david/jasancheg/sails-custom-swagger-hook.svg?style=flat" alt="Dependency Status"></a></p>

<blockquote>
<p>Important! develoment in progress..</p>
</blockquote>

<ul>
<li>
<a href="http://swagger.io/">swagger.io</a> hook for <a href="http://sailsjs.org/">Sails JS</a>.</li>
<li>Customized to support the Swagger 2.0 specification, it is a simple and clean solution to integrate swagger with Sails JS, the application's models, controllers, and routes are automatically aggregated and transformed into a Swagger Document.</li>
<li>Based in forks(outdated) of <a href="https://github.com/fliptoo/swagger-express">swagger-express</a>, <a href="https://github.com/tjwebb/sails-swagger">sails-swagger</a> and <a href="https://github.com/qbanguy/sails-swagr">sails-swagr</a>, but uptate and personalize to use with up to date dependencies and with a couple of extra features for allow inject CSS and JS files for brand personalization.</li>
</ul>

<h3>
<a id="summary" class="anchor" href="#summary" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Summary</h3>

<p>This module will do it best to autogenerate everything it can from Sails configuration and create
a Swagger 2.0 JSON Specification to be used with the Swagger-UI. After routes and models have been generated,
you may create a <code>docs</code> directory under <code>api/</code> and place YML documents with paths definitions for each Controller. As a result, the generated JSONs and YAMLs will be <strong>merged</strong>.</p>

<p>Here is how documentation API page looks like (<a href="https://github.com/jasancheg/sails-custom-swagger-hook/blob/master/samples/picture-1.png">sample</a>):</p>

<p><img src="https://raw.githubusercontent.com/jasancheg/sails-custom-swagger-hook/master/samples/picture-1.png" alt=""></p>

<p><strong>Logs</strong>
<img src="https://raw.githubusercontent.com/jasancheg/sails-custom-swagger-hook/master/samples/picture-2.png" alt=""></p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<pre><code>$ npm install sails-custom-swagger-hook --save
</code></pre>

<h2>
<a id="quick-start" class="anchor" href="#quick-start" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Quick Start</h2>

<p>Configure hook as express middleware.</p>

<table>
<thead>
<tr>
<th>Key</th>
<th>Example value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>apiVersion</code></td>
<td>'1.0'</td>
<td align="left">Your api version.</td>
</tr>
<tr>
<td><code>swaggerVersion</code></td>
<td>'2.0'</td>
<td align="left">Swagger version.</td>
</tr>
<tr>
<td><code>swaggerURL</code></td>
<td>'/api/docs'</td>
<td align="left">Path to use for swagger ui web interface.</td>
</tr>
<tr>
<td><code>swaggerJSON</code></td>
<td>'/api-docs.json'</td>
<td align="left">Path to use for swagger ui JSON.</td>
</tr>
<tr>
<td><code>basePath</code></td>
<td>sails.config.appUrl</td>
<td align="left">The basePath for swagger.js</td>
</tr>
<tr>
<td><code>info</code></td>
<td>{ title: '', description: ''}</td>
<td align="left">[Metadata][info] about the API</td>
</tr>
<tr>
<td><code>apis</code></td>
<td>['./api/docs/User.yml']</td>
<td align="left">Define your api array.</td>
</tr>
<tr>
<td><code>middleware</code></td>
<td>fn</td>
<td align="left">Function before response.</td>
</tr>
<tr>
<td><code>custom</code></td>
<td>{folder: sails.config.appPath + '/assets/docs'}</td>
<td align="left">Path to folder where <code>custom-swagger.css</code> and <code>custom-swagger.js</code> are stored</td>
</tr>
</tbody>
</table>

<blockquote>
<p>Note:</p>

<ul>
<li>
<code>sails.config.appPath</code> is provided by sails js</li>
<li>
<code>sails.config.appUrl</code> is a environment variable, please see: <a href="http://sailsjs.org/documentation/reference/application/sails-get-base-url">sails environment variables</a>
</li>
<li>Currently the implementation for personalization is very basic, you can place the folder for the customization files in any convenient folder of your application, for example <code>assets/docs</code>, however the name for the css/js files are mandatory. For properly operation of the hook please preserve the name for <code>custom-swagger.css</code> and <code>custom-swagger.js</code>
</li>
<li>Files placed in your customization folder are availables as static assets, For example if your customization folder is <code>assets/docs</code> any file placed on the folder is available in the url <code>{host path}/api/docs/{file path/name}</code>
</li>
</ul>
</blockquote>

<h4>
<a id="simple-set-sailsconfigapppath-variable" class="anchor" href="#simple-set-sailsconfigapppath-variable" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Simple set sails.config.appPath variable</h4>

<p>Read:</p>

<ul>
<li><a href="http://sailsjs.org/documentation/reference/application/sails-get-base-url">Environment-specific files</a></li>
<li><a href="http://sailsjs.org/documentation/concepts/configuration#?environmentspecific-files-config-env">sails get base url</a></li>
</ul>

<p><em>Steps (e.g.):</em></p>

<ul>
<li>In your <code>config/local.js</code> file add the value <code>appUrl: "http://localhost:1337"</code>
</li>
<li>In your <code>config/env/heroku.js</code> file add the value <code>appUrl: "http://myapp.herokuapp.com"</code>
</li>
<li>In your <code>config/env/development.js</code> file add the value <code>appUrl: "http://dev.myapp.com"</code>
</li>
<li>In your <code>config/env/staging.js</code> file add the value <code>appUrl: "http://stg.myapp.com"</code>
</li>
<li>In your <code>config/env/production.js</code> file add the value <code>appUrl: "http://myapp.com"</code>
</li>
<li>Set the properly NODE_ENV variable on each environment that you configure</li>
</ul>

<h2>
<a id="sails-integration" class="anchor" href="#sails-integration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Sails Integration</h2>

<p>Modify the <code>config/http.js</code> to look like:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-en">customMiddleware</span><span class="pl-k">:</span> <span class="pl-k">function</span> (<span class="pl-smi">app</span>) {
  <span class="pl-k">var</span> swagger <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>sails-custom-swagger-hook<span class="pl-pds">'</span></span>);
  <span class="pl-k">var</span> express <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>express<span class="pl-pds">'</span></span>);

  <span class="pl-smi">app</span>.<span class="pl-en">use</span>(<span class="pl-smi">swagger</span>.<span class="pl-en">init</span>(express, app, {
    apiVersion<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>1.0<span class="pl-pds">'</span></span>,
    swaggerVersion<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>2.0<span class="pl-pds">'</span></span>,
    swaggerURL<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>/api/docs<span class="pl-pds">'</span></span>,
    swaggerJSON<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>/api-docs.json<span class="pl-pds">'</span></span>,
    basePath<span class="pl-k">:</span> <span class="pl-smi">sails</span>.<span class="pl-smi">config</span>.<span class="pl-smi">appUrl</span>,
    info<span class="pl-k">:</span> {
      title<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span> App API Documentation<span class="pl-pds">'</span></span>,
      description<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Full API Test Harness<span class="pl-pds">'</span></span>
    },
    custom<span class="pl-k">:</span> {
      folder<span class="pl-k">:</span> <span class="pl-smi">sails</span>.<span class="pl-smi">config</span>.<span class="pl-smi">appPath</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>/assets/docs<span class="pl-pds">'</span></span>
    },
    apis<span class="pl-k">:</span> [
      <span class="pl-s"><span class="pl-pds">'</span>./api/docs/User.yml<span class="pl-pds">'</span></span>,
    ]
  }));
  <span class="pl-smi">sails</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>ready<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>() {
    <span class="pl-smi">swagger</span>.<span class="pl-en">sailsGenerate</span>({
      routes<span class="pl-k">:</span> <span class="pl-smi">sails</span>.<span class="pl-smi">router</span>.<span class="pl-smi">_privateRouter</span>.<span class="pl-smi">routes</span>,
      models<span class="pl-k">:</span> <span class="pl-smi">sails</span>.<span class="pl-smi">models</span>
    });
  });
},
</pre></div>

<h2>
<a id="inject-files-for-look-and-feel-customization-a-js-and-css-file" class="anchor" href="#inject-files-for-look-and-feel-customization-a-js-and-css-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Inject files for look and feel customization, a JS and CSS file</h2>

<p>Place the personalization files in your selected folder, for example '/assets/docs'. Find below a example for each one of this files:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// @Name: custom-swagger.js</span>

<span class="pl-c">// Swagger UI uses jQuery,</span>
<span class="pl-c">// so there is not problem with to use it here</span>
<span class="pl-en">$</span>(<span class="pl-c1">document</span>).<span class="pl-en">ready</span>(<span class="pl-k">function</span>() {

  <span class="pl-c">// Change page title</span>
  <span class="pl-en">$</span>(<span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>).<span class="pl-c1">text</span>(<span class="pl-s"><span class="pl-pds">"</span>App Name<span class="pl-pds">"</span></span>);

  <span class="pl-c">// Change logo link</span>
  <span class="pl-en">$</span>(<span class="pl-s"><span class="pl-pds">"</span>#logo<span class="pl-pds">"</span></span>).<span class="pl-en">attr</span>(
    <span class="pl-s"><span class="pl-pds">'</span>href<span class="pl-pds">'</span></span>,
    <span class="pl-c1">document</span>.<span class="pl-c1">location</span>.<span class="pl-c1">protocol</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>//<span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-c1">document</span>.<span class="pl-c1">location</span>.<span class="pl-c1">host</span>
  );

  <span class="pl-c">// Change brand text</span>
  <span class="pl-en">$</span>(<span class="pl-s"><span class="pl-pds">"</span>.logo__title<span class="pl-pds">"</span></span>).<span class="pl-c1">text</span>(<span class="pl-s"><span class="pl-pds">"</span>App name<span class="pl-pds">"</span></span>);

  <span class="pl-c">// Change logo image</span>
  <span class="pl-c">// all files added to the folder with custom files</span>
  <span class="pl-c">// is public in /api/docs/{path to file}</span>
  <span class="pl-c">// also you can use the assets folder provided by sails</span>
  <span class="pl-c">// to store an image or point to an external file</span>
  <span class="pl-en">$</span>(<span class="pl-s"><span class="pl-pds">"</span>.logo__img<span class="pl-pds">"</span></span>).<span class="pl-en">attr</span>({
    alt<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>App name<span class="pl-pds">"</span></span>,
    height<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>30<span class="pl-pds">"</span></span>,
    width<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>30<span class="pl-pds">"</span></span>,
    src<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>smile.png<span class="pl-pds">"</span></span>
  });

});</pre></div>

<p>CSS file</p>

<div class="highlight highlight-source-css"><pre><span class="pl-c">/* @Name: custom-swagger.css */</span>

<span class="pl-e">#custom-swagger</span> <span class="pl-e">.swagger-section</span> <span class="pl-e">#header</span> {
  <span class="pl-c1"><span class="pl-c1">background-color</span></span>: <span class="pl-c1">#2BA0D3</span>;
}

<span class="pl-e">#custom-swagger</span> <span class="pl-e">.swagger-section</span> <span class="pl-e">#explore</span>,
<span class="pl-e">#custom-swagger</span> <span class="pl-e">.swagger-section</span> <span class="pl-e">#auth_container</span> <span class="pl-e">.authorize__btn</span> {
  <span class="pl-c1"><span class="pl-c1">background-color</span></span>: <span class="pl-c1">#42BFeF</span>;
}

<span class="pl-e">#custom-swagger</span> <span class="pl-e">.swagger-section</span> <span class="pl-e">#api_selector</span> <span class="pl-ent">input</span> {
  <span class="pl-c1"><span class="pl-c1">height</span></span>: <span class="pl-c1">20<span class="pl-k">px</span></span>;
  <span class="pl-c1"><span class="pl-c1">padding</span></span>: <span class="pl-c1">4<span class="pl-k">px</span></span> <span class="pl-c1">12<span class="pl-k">px</span></span>;
  <span class="pl-c1"><span class="pl-c1">background-color</span></span>: <span class="pl-c1">#fff</span>;
  <span class="pl-c1"><span class="pl-c1">background-image</span></span>: <span class="pl-c1">none</span>;
  <span class="pl-c1"><span class="pl-c1">border</span></span>: <span class="pl-c1">1<span class="pl-k">px</span></span> <span class="pl-c1">solid</span> <span class="pl-c1">#ccc</span>;
  <span class="pl-c1"><span class="pl-c1">border-radius</span></span>: <span class="pl-c1">4<span class="pl-k">px</span></span>;
  <span class="pl-c1"><span class="pl-c1">box-shadow</span></span>: <span class="pl-c1">inset</span> <span class="pl-c1">0</span> <span class="pl-c1">1<span class="pl-k">px</span></span> <span class="pl-c1">1<span class="pl-k">px</span></span> <span class="pl-c1">rgba</span>(<span class="pl-c1">0,0,0,.075</span>);
  <span class="pl-c1">-webkit-<span class="pl-c1">transition</span></span>: border-color ease-in-out <span class="pl-c1">.15<span class="pl-k">s</span></span>,box-shadow ease-in-out <span class="pl-c1">.15<span class="pl-k">s</span></span>;
  <span class="pl-c1"><span class="pl-c1">transition</span></span>: border-color ease-in-out <span class="pl-c1">.15<span class="pl-k">s</span></span>,box-shadow ease-in-out <span class="pl-c1">.15<span class="pl-k">s</span></span>;
  <span class="pl-c1"><span class="pl-c1">color</span></span>: <span class="pl-c1">#777</span>;
  <span class="pl-c1"><span class="pl-c1">line-height</span></span>: <span class="pl-c1">1.4<span class="pl-k">em</span></span>;
}</pre></div>

<h4>
<a id="swagger-ui" class="anchor" href="#swagger-ui" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Swagger-UI</h4>

<p>Lift sails and navigate to the specified <code>swaggerURL</code> e.g.</p>

<pre><code>http://localhost:1337/api/docs
</code></pre>

<h2>
<a id="read-from-yaml-file" class="anchor" href="#read-from-yaml-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Read from YAML file</h2>

<p>Example 'Users.yml'</p>

<div class="highlight highlight-source-yaml"><pre>
<span class="pl-ent">paths:</span>
  <span class="pl-ent">/login:</span>
    <span class="pl-ent">post:</span>
      <span class="pl-ent">summary:</span> <span class="pl-s">Login with username and password</span>
      <span class="pl-ent">notes:</span> <span class="pl-s">Returns a user based on username</span>
      <span class="pl-ent">responseClass:</span> <span class="pl-s">User</span>
      <span class="pl-ent">nickname:</span> <span class="pl-s">login</span>
      <span class="pl-ent">consumes:</span>
        - <span class="pl-s">text/html</span>
      <span class="pl-ent">parameters:</span>

      - <span class="pl-ent">name:</span> <span class="pl-s">username</span>
        <span class="pl-ent">dataType:</span> <span class="pl-s">string</span>
        <span class="pl-ent">paramType:</span> <span class="pl-s">query</span>
        <span class="pl-ent">required:</span> <span class="pl-c1">true</span>
        <span class="pl-ent">description:</span> <span class="pl-s">Your username</span>

      - <span class="pl-ent">name:</span> <span class="pl-s">password</span>
        <span class="pl-ent">dataType:</span> <span class="pl-s">string</span>
        <span class="pl-ent">paramType:</span> <span class="pl-s">query</span>
        <span class="pl-ent">required:</span> <span class="pl-c1">true</span>
        <span class="pl-ent">description:</span> <span class="pl-s">Your password</span>

<span class="pl-ent">definitions:</span>
  <span class="pl-ent">User:</span>
    <span class="pl-ent">properties:</span>
      <span class="pl-ent">username:</span>
        <span class="pl-ent">type:</span> <span class="pl-s">String</span>
      <span class="pl-ent">password:</span>
        <span class="pl-ent">type:</span> <span class="pl-s">String</span></pre></div>

<p><a href="http://swagger.io/">Swagger</a> is a specification and complete framework
implementation for describing, producing, consuming, and visualizing RESTful web services.
View <a href="http://petstore.swagger.io/">demo</a>.</p>

<p>That’s it!</p>

<h1>
<a id="credits" class="anchor" href="#credits" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Credits</h1>

<ul>
<li>
<a href="https://github.com/fliptoo/swagger-express">swagger-express</a>,</li>
<li><a href="https://github.com/tjwebb/sails-swagger">sails-swagger</a></li>
<li><a href="https://github.com/qbanguy/sails-swagr">sails-swagr</a></li>
<li><a href="https://github.com/swagger-api/swagger-ui">swagger-ui</a></li>
</ul>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h2>

<p>The <a href="https://github.com/jasancheg/sails-custom-swagger-hook/blob/master/LICENSE">MIT</a> License, © <a href="https://github.com/jasancheg/">jasancheg</a></p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/jasancheg/sails-custom-swagger-hook/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/jasancheg/sails-custom-swagger-hook/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/jasancheg/sails-custom-swagger-hook"></a> is maintained by <a href="https://github.com/jasancheg">jasancheg</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
